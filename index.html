<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¯ãƒªãƒƒã‚«ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #fff;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    .container {
      max-width: 700px;
      margin: 20px auto;
      padding: 20px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    h2 {
      color: #1e3c72;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }
    button {
      padding: 12px 24px;
      margin: 8px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      transition: transform 0.2s, box-shadow 0.2s;
      color: white;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    button:active {
      transform: scale(0.95);
    }
    #clickButton {
      font-size: 28px;
      padding: 20px 40px;
      background: #e91e63;
      border-radius: 50%;
      width: 100px;
      height: 100px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .point-pop {
      position: absolute;
      color: #ffd700;
      font-size: 20px;
      font-weight: bold;
      animation: floatUp 1s ease-out forwards;
      pointer-events: none;
    }
    @keyframes floatUp {
      0% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-50px); }
    }
    #loginScreen, #gameScreen, #upgradesScreen, #settingsScreen {
      display: none;
    }
    #loginScreen.active, #gameScreen.active, #upgradesScreen.active, #settingsScreen.active {
      display: block;
    }
    .tab-bar {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .tab-button {
      background: #3f51b5;
    }
    .upgrade-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 20px;
    }
    .upgrade-button {
      background: #ff5722;
      position: relative;
      overflow: hidden;
    }
    .upgrade-button.disabled {
      background: #999;
      cursor: not-allowed;
    }
    .upgrade-button::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.4s, height 0.4s;
    }
    .upgrade-button:hover::after {
      width: 200px;
      height: 200px;
    }
    input, select {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    .profile-section {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ãƒ­ã‚°ã‚¤ãƒ³/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆç”»é¢ -->
    <div id="loginScreen" class="active">
      <h2>ã‚¯ãƒªãƒƒã‚«ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
      <input type="text" id="usernameInput" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
      <select id="iconSelect">
        <option value="ğŸ˜º">ğŸ˜º çŒ«</option>
        <option value="ğŸ¶">ğŸ¶ çŠ¬</option>
        <option value="ğŸ¦">ğŸ¦ ãƒ©ã‚¤ã‚ªãƒ³</option>
        <option value="ğŸ¦„">ğŸ¦„ ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ³</option>
      </select>
      <button onclick="createAccount()">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</button>
      <button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
    </div>

    <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
    <div id="gameScreen">
      <h2>ã‚¯ãƒªãƒƒã‚«ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>
      <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼: <span id="displayUsername"></span> (<span id="displayIcon"></span>)</p>
      <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: <span id="userId"></span></p>
      <p>ãƒã‚¤ãƒ³ãƒˆ: <span id="points">0</span></p>
      <button id="clickButton" onclick="clickPoint()">ã‚¯ãƒªãƒƒã‚¯ï¼</button>
      <div>
        <button onclick="toggleClickMode('auto')">ã‚ªãƒ¼ãƒˆã‚¯ãƒªãƒƒã‚¯</button>
        <button onclick="toggleClickMode('quick')">ã‚¯ã‚¤ãƒƒã‚¯ã‚¯ãƒªãƒƒã‚¯</button>
        <p>ãƒ¢ãƒ¼ãƒ‰: <span id="clickMode">æ‰‹å‹•</span></p>
      </div>
      <div class="tab-bar">
        <button class="tab-button" onclick="showUpgrades()">ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</button>
        <button class="tab-button" onclick="showSettings()">è¨­å®š</button>
      </div>
    </div>

    <!-- ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç”»é¢ -->
    <div id="upgradesScreen">
      <h2>ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</h2>
      <p>ãƒã‚¤ãƒ³ãƒˆ: <span id="upgradePoints">0</span></p>
      <div class="upgrade-section">
        <button class="upgrade-button" onclick="buyUpgrade(0)">ã‚¯ãƒªãƒƒã‚¯å¼·åŒ–<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost0">10</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel0">0</span></button>
        <button class="upgrade-button" onclick="buyUpgrade(1)">ã‚ªãƒ¼ãƒˆé€Ÿåº¦<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost1">50</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel1">0</span></button>
        <button class="upgrade-button" onclick="buyUpgrade(2)">ã‚¯ã‚¤ãƒƒã‚¯ãƒœãƒ¼ãƒŠã‚¹<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost2">100</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel2">0</span></button>
        <button class="upgrade-button" onclick="buyUpgrade(3)">ãƒã‚¤ãƒ³ãƒˆå€ç‡<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost3">200</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel3">0</span></button>
        <button class="upgrade-button" onclick="buyUpgrade(4)">ã‚ªãƒ¼ãƒˆåŠ¹ç‡<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost4">500</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel4">0</span></button>
        <button class="upgrade-button" onclick="buyUpgrade(5)">ãƒ©ãƒƒã‚­ãƒ¼ãƒœãƒ¼ãƒŠã‚¹<br>ã‚³ã‚¹ãƒˆ: <span id="upgradeCost5">1000</span><br>ãƒ¬ãƒ™ãƒ«: <span id="upgradeLevel5">0</span></button>
      </div>
      <button class="tab-button" onclick="backToGame()">æˆ»ã‚‹</button>
    </div>

    <!-- è¨­å®šç”»é¢ -->
    <div id="settingsScreen">
      <h2>è¨­å®š</h2>
      <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: <span id="settingsUserId"></span></p>
      <input type="text" id="newUsername" placeholder="æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼å">
      <select id="newIcon">
        <option value="ğŸ˜º">ğŸ˜º çŒ«</option>
        <option value="ğŸ¶">ğŸ¶ çŠ¬</option>
        <option value="ğŸ¦">ğŸ¦ ãƒ©ã‚¤ã‚ªãƒ³</option>
        <option value="ğŸ¦„">ğŸ¦„ ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ³</option>
      </select>
      <button onclick="updateProfile()">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°</button>
      <button onclick="confirmReset()">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒªã‚»ãƒƒãƒˆ</button>
      <button onclick="confirmDelete()">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤</button>
      <button class="tab-button" onclick="backToGame()">æˆ»ã‚‹</button>
    </div>
  </div>

  <script>
    let points = 0;
    let user = null;
    let clickMode = 'manual';
    let upgrades = [
      { level: 0, cost: 10, effect: 1 }, // ã‚¯ãƒªãƒƒã‚¯å¼·åŒ–
      { level: 0, cost: 50, effect: 0.1 }, // ã‚ªãƒ¼ãƒˆé€Ÿåº¦
      { level: 0, cost: 100, effect: 2 }, // ã‚¯ã‚¤ãƒƒã‚¯ãƒœãƒ¼ãƒŠã‚¹
      { level: 0, cost: 200, effect: 1.5 }, // ãƒã‚¤ãƒ³ãƒˆå€ç‡
      { level: 0, cost: 500, effect: 0.2 }, // ã‚ªãƒ¼ãƒˆåŠ¹ç‡
      { level: 0, cost: 1000, effect: 0.05 } // ãƒ©ãƒƒã‚­ãƒ¼ãƒœãƒ¼ãƒŠã‚¹
    ];
    let autoInterval = null;

    // UUIDç”Ÿæˆé–¢æ•°
    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
    function createAccount() {
      const username = document.getElementById('usernameInput').value;
      const iconwards = document.getElementById('iconSelect').value;
      if (username) {
        const userId = generateUUID();
        user = { id: userId, username, icon: iconwards, points: 0, upgrades: upgrades, clickMode: 'manual' };
        localStorage.setItem('clickerUser', JSON.stringify(user));
        console.log('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ:', user);
        loadGame();
      } else {
        alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
      }
    }

    // ãƒ­ã‚°ã‚¤ãƒ³
    function login() {
      const savedUser = localStorage.getItem('clickerUser');
      if (savedUser) {
        user = JSON.parse(savedUser);
        console.log('ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ:', user);
        loadGame();
      } else {
        alert('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ä½œæˆã—ã¦ãã ã•ã„ã€‚');
      }
    }

    // ã‚²ãƒ¼ãƒ ç”»é¢ã®èª­ã¿è¾¼ã¿
    function loadGame() {
      document.getElementById('loginScreen').classList.remove('active');
      document.getElementById('gameScreen').classList.add('active');
      points = user.points;
      upgrades = user.upgrades;
      clickMode = user.clickMode;
      console.log('ã‚²ãƒ¼ãƒ ç”»é¢èª­ã¿è¾¼ã¿:', { points, clickMode });
      updateUI();
      if (clickMode === 'auto' && upgrades[1].level > 0) {
        startAutoClick();
      }
    }

    // UIæ›´æ–°
    function updateUI() {
      document.getElementById('points').textContent = Math.floor(points);
      document.getElementById('upgradePoints').textContent = Math.floor(points);
      document.getElementById('displayUsername').textContent = user.username;
      document.getElementById('displayIcon').textContent = user.icon;
      document.getElementById('userId').textContent = user.id;
      document.getElementById('clickMode').textContent = clickMode === 'auto' ? 'ã‚ªãƒ¼ãƒˆã‚¯ãƒªãƒƒã‚¯' : clickMode === 'quick' ? 'ã‚¯ã‚¤ãƒƒã‚¯ã‚¯ãƒªãƒƒã‚¯' : 'æ‰‹å‹•';
      upgrades.forEach((upgrade, i) => {
        document.getElementById(`upgradeCost${i}`).textContent = upgrade.cost;
        document.getElementById(`upgradeLevel${i}`).textContent = upgrade.level;
        const button = document.getElementsByClassName('upgrade-button')[i];
        button.disabled = points < upgrade.cost;
        button.classList.toggle('disabled', points < upgrade.cost);
      });
      saveGame();
    }

    // ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
    function clickPoint() {
      if (clickMode === 'quick' && upgrades[2].level === 0) {
        alert('ã‚¯ã‚¤ãƒƒã‚¯ã‚¯ãƒªãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã¯ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ï¼');
        return;
      }
      let pointGain = 1 + upgrades[0].level * upgrades[0].effect;
      if (clickMode === 'quick') pointGain *= (1 + upgrades[2].level * upgrades[2].effect);
      pointGain *= (1 + upgrades[3].level * upgrades[3].effect);
      if (upgrades[5].level > 0 && Math.random() < upgrades[5].level * upgrades[5].effect) {
        pointGain *= 2;
      }
      points += pointGain;
      showPointPop(pointGain);
      updateUI();
      console.log('ã‚¯ãƒªãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ:', pointGain);
    }

    // ãƒã‚¤ãƒ³ãƒˆãƒãƒƒãƒ—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    function showPointPop(amount) {
      const pop = document.createElement('div');
      pop.className = 'point-pop';
      pop.textContent = `+${Math.floor(amount)}`;
      pop.style.left = `${Math.random() * 100 + 300}px`;
      pop.style.top = '50%';
      document.body.appendChild(pop);
      setTimeout(() => pop.remove(), 1000);
    }

    // ã‚¯ãƒªãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
    function toggleClickMode(mode) {
      if (mode === 'auto' && upgrades[1].level === 0) {
        alert('ã‚ªãƒ¼ãƒˆã‚¯ãƒªãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã¯ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ï¼');
        return;
      }
      clickMode = mode;
      if (mode === 'auto') {
        startAutoClick();
      } else {
        clearInterval(autoInterval);
      }
      updateUI();
      console.log('ã‚¯ãƒªãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´:', mode);
    }

    // ã‚ªãƒ¼ãƒˆã‚¯ãƒªãƒƒã‚¯é–‹å§‹
    function startAutoClick() {
      clearInterval(autoInterval);
      autoInterval = setInterval(() => {
        let pointGain = upgrades[1].level * upgrades[1].effect;
        pointGain *= (1 + upgrades[4].level * upgrades[4].effect);
        if (upgrades[5].level > 0 && Math.random() < upgrades[5].level * upgrades[5].effect) {
          pointGain *= 2;
        }
        points += pointGain;
        updateUI();
      }, 1000);
      console.log('ã‚ªãƒ¼ãƒˆã‚¯ãƒªãƒƒã‚¯é–‹å§‹');
    }

    // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰è³¼å…¥
    function buyUpgrade(index) {
      if (points >= upgrades[index].cost) {
        points -= upgrades[index].cost;
        upgrades[index].level++;
        upgrades[index].cost = Math.round(upgrades[index].cost * 1.5);
        if (index === 1 && clickMode === 'auto') {
          startAutoClick();
        }
        updateUI();
        console.log(`ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰${index}è³¼å…¥: ãƒ¬ãƒ™ãƒ«${upgrades[index].level}`);
      } else {
        alert('ãƒã‚¤ãƒ³ãƒˆãŒè¶³ã‚Šã¾ã›ã‚“ï¼');
      }
    }

    // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç”»é¢è¡¨ç¤º
    function showUpgrades() {
      document.getElementById('gameScreen').classList.remove('active');
      document.getElementById('upgradesScreen').classList.add('active');
      updateUI();
      console.log('ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ç”»é¢è¡¨ç¤º');
    }

    // è¨­å®šç”»é¢è¡¨ç¤º
    function showSettings() {
      document.getElementById('gameScreen').classList.remove('active');
      document.getElementById('upgradesScreen').classList.remove('active');
      document.getElementById('settingsScreen').classList.add('active');
      document.getElementById('settingsUserId').textContent = user.id;
      document.getElementById('newUsername').value = user.username;
      document.getElementById('newIcon').value = user.icon;
      console.log('è¨­å®šç”»é¢è¡¨ç¤º');
    }

    // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°
    function updateProfile() {
      const newUsername = document.getElementById('newUsername').value;
      const newIcon = document.getElementById('newIcon').value;
      if (newUsername) {
        user.username = newUsername;
        user.icon = newIcon;
        updateUI();
        backToGame();
        console.log('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°:', { username: newUsername, icon: newIcon });
      } else {
        alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
      }
    }

    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒªã‚»ãƒƒãƒˆç¢ºèª
    function confirmReset() {
      if (confirm('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
        points = 0;
        upgrades = [
          { level: 0, cost: 10, effect: 1 },
          { level: 0, cost: 50, effect: 0.1 },
          { level: 0, cost: 100, effect: 2 },
          { level: 0, cost: 200, effect: 1.5 },
          { level: 0, cost: 500, effect: 0.2 },
          { level: 0, cost: 1000, effect: 0.05 }
        ];
        clickMode = 'manual';
        clearInterval(autoInterval);
        user.points = points;
        user.upgrades = upgrades;
        user.clickMode = clickMode;
        updateUI();
        console.log('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒªã‚»ãƒƒãƒˆ');
      }
    }

    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ç¢ºèª
    function confirmDelete() {
      const inputId = prompt('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã®å…¥åŠ›ãŒå¿…è¦ã§ã™:');
      if (inputId === user.id) {
        localStorage.removeItem('clickerUser');
        window.location.reload();
        console.log('ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤');
      } else {
        alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ï¼');
      }
    }

    // ã‚²ãƒ¼ãƒ ã«æˆ»ã‚‹
    function backToGame() {
      document.getElementById('settingsScreen').classList.remove('active');
      document.getElementById('upgradesScreen').classList.remove('active');
      document.getElementById('gameScreen').classList.add('active');
      console.log('ã‚²ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹');
    }

    // ã‚²ãƒ¼ãƒ ä¿å­˜
    function saveGame() {
      user.points = points;
      user.upgrades = upgrades;
      user.clickMode = clickMode;
      localStorage.setItem('clickerUser', JSON.stringify(user));
      console.log('ã‚²ãƒ¼ãƒ ä¿å­˜:', user);
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç¢ºèª
    window.onload = () => {
      const savedUser = localStorage.getItem('clickerUser');
      if (savedUser) {
        user = JSON.parse(savedUser);
        loadGame();
      } else {
        console.log('æ—¢å­˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãªã—');
      }
    };
  </script>
</body>
</html>